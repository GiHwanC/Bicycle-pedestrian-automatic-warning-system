# 🚲 자전거–보행자 자동 경고 시스템 

> Intel RealSense D455 + YOLOv5 + MTCNN 기반 보행자 위험 감지 솔루션  
> 보행자-자전거 혼합도로에서 **“뒤돌아보지 못하는 보행자”** 를 위한 자동 경고 시스템

---

## 📌 프로젝트 개요

- **프로젝트 기간:** 2024.09.02 ~ 2024.12.21  
- **사용 기술:** `YOLOv5` `MTCNN` `Intel RealSense D455` `Python` `Raspberry Pi 5`  
- **목표:**  
  - 자전거-보행자 혼합 보행도로에서,  
    **뒤에서 접근하는 자전거를 인지하지 못하는 보행자에게 실시간 경고**를 제공하는 시스템 개발
  - Depth 카메라 기반 실제 거리 계산 + 얼굴 인식 결과를 결합해  
    **상황 인지 여부까지 판단하는 지능형 경고 로직** 구현

---

## 👥 팀 구성 및 역할

| 이름            | 역할                        | 주요 기여 |
|----------------|-----------------------------|-----------|
|김기환| AI · 임베디드 통합 개발         |  RealSense + YOLO 시스템 설계, 위험 판단 알고리즘 설계, Raspberry Pi GPIO(부저·램프) 제어 펌웨어, 테스트 시나리오 설계 및 개선 |
|김00| 데이터 수집 & 실험 보조          | 프로젝트 전체 구조 설계, MTCNN 로직 통합, 자전거 주행 테스트, 촬영 환경 세팅, 라벨링 및 실험 보조 |

---

## 🎯 문제 정의

1. **보행자의 등(Back) 방향 문제**  
   - 대부분의 충돌 사고는 보행자가 **뒤를 돌아보지 못한 상태**에서 발생  
   - 얼굴이 보이지 않으면 자전거의 접근 자체를 인지하지 못함  

2. **거리 오판에 의한 대응 지연**  
   - 일반 영상만으로는 정확한 실제 거리 측정이 어려움  
   - 조명·각도·거리 변화에 따라 인식 정확도 및 위험 판단 기준이 크게 변동  

3. **보행자-자전거 혼합도로에서의 인지 부족**  
   - 자전거는 빠른 속도로 진입하지만  
   - 보행자는 이어폰/전화/시야 제한으로 접근을 잘 인지하지 못함  
   - 물리적인 안전 시설이나 경고 장치가 거의 없는 환경이 많음

---

## 🧠 핵심 아이디어

### 1. 사람 인식 – YOLOv5
- 자전거 주행 중 실시간으로 **person 클래스만 탐지**
- 다양한 조명·거리·각도에서 안정적인 동작을 목표로 세부 파라미터 튜닝

### 2. 얼굴 검출 – MTCNN
- YOLO로 검출된 영역 주변에서 **얼굴 유무를 추가 판단**
- 얼굴이 보이지 않으면  
  → **보행자가 자전거 방향을 보고 있지 않다**고 판단  
  → 위험도 가중치 상향

### 3. Depth 기반 실제 거리 계산 – RealSense D455
- Depth Frame에서 **bounding box 중심 주변 픽셀들의 깊이값 평균**  
- 이를 통해 사람과의 실제 거리(m) 산출  
- 실험을 통해 **6 m 이내**를 경고 기준으로 설정

### 4. 위험 감지 알고리즘

다음 두 조건을 **모두 만족**할 때 경고 발동:

1. 사람인지 - YOLOv5
2. 사람까지의 실제 거리 `≤ 6 m` - Depth Data
3. 얼굴 검출 실패 (보행자가 뒤를 보고 있거나, 시선이 반대 방향) - MTCNN

→ **부저(Buzzer)** : 0.5초 간격 토글 = 청각적 경고
→ **램프(Lamp)** : 2초간 점등(릴레이 모듈 사용) = 시각적 경고

---

## 🧱 시스템 구조

```text
[RealSense D455]  (RGB + Depth)
          │
          ▼
[YOLOv5 Person Detection]
          │
          ▼
[MTCNN Face Detection]
          │
          ▼
[Depth 기반 거리 계산]
          │
          ▼
[위험 판단 알고리즘]
          │
          ▼
[부저 / 램프 경고 (Raspberry Pi GPIO)]
